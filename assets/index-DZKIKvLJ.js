var O=Object.defineProperty;var T=(i,t,e)=>t in i?O(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var h=(i,t,e)=>(T(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();const N=document.getElementById("canvas");class p{constructor(t,e){this.x=t,this.y=e}}class u{constructor(t,e,r,s,n){this.position=t,this.width=e,this.height=r,this.ctx=s,this.image=new Image,this.image.src=n}draw(){console.log("platform draw called"),this.ctx.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}update(t){this.position.y>t&&(this.position.x=Math.floor(Math.random()*N.width*3/4),this.position.y=-this.height)}}const R=document.getElementById("canvas");class A{constructor(t,e,r,s,n,d,f,y){h(this,"position");h(this,"width");h(this,"height");h(this,"Rightimgsrc");h(this,"leftimgsrc");h(this,"ctx");h(this,"image");h(this,"vx");h(this,"vy");h(this,"gravity");h(this,"jumpspeed");this.position=t,this.width=e,this.height=r,this.Rightimgsrc=s,this.leftimgsrc=n,this.ctx=d,this.image=new Image,this.image.src=this.Rightimgsrc,this.vx=0,this.vy=0,this.gravity=f,this.jumpspeed=y,this.addEvent()}update(){this.position.x+=this.vx,this.vy+=this.gravity,this.position.y+=this.vy,this.position.x>R.width?this.position.x=0:this.position.x+this.width<0&&(this.position.x=R.width-10),this.vy>15&&(this.vy=15)}addEvent(){document.addEventListener("keydown",t=>{t.code=="ArrowRight"||t.key=="d"?this.moveX(4,this.Rightimgsrc):(t.code=="ArrowLeft"||t.key=="a")&&this.moveX(-4,this.leftimgsrc)}),document.addEventListener("keyup",t=>{(t.code=="ArrowRight"||t.code=="ArrowLeft"||t.key=="d"||t.key=="a")&&(this.vx=0)})}draw(){this.ctx.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}reset(t){this.position=t,this.vx=0,this.vy=0,this.image.src=this.Rightimgsrc}moveX(t,e){this.vx=t,this.image.src=e}jump(){this.vy=this.jumpspeed}}function C(i,t){return i.position.x<t.position.x+t.width&&i.position.x+i.width>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}window.onload=()=>{const i=document.getElementById("canvas"),t=i.getContext("2d"),e=360,r=540,s=18,n=60;let d=!1,f=0;const y=-12,k=.4;let g="start";i.width=e,i.height=r;let S=new Image;S.src="./doodlejumpbg.png";function w(){t.drawImage(S,0,0,i.width,i.height)}function L(){t.clearRect(0,0,i.width,i.height),w(),t.fillStyle="red",t.font="48px 'Comic Neue', sans-serif",t.fillText("doodle jump",e/2-120,100),t.fillStyle="black",t.font="36px 'Comic Neue', sans-serif",t.fillText("play",e/2-30,250),t.fillStyle="green",t.font="36px 'Comic Neue', sans-serif",t.fillText("press Enter to start",e/2-140,350),t.beginPath(),t.strokeStyle="black",t.lineWidth=3,t.roundRect(e/2-60,210,120,50,10),t.stroke()}function M(){let o=localStorage.getItem("doodle_score"),c=!1;o=o?parseInt(o):0,f>o&&(localStorage.setItem("doodle_score",f.toString()),c=!0,o=f),t.clearRect(0,0,i.width,i.height),w(),t.fillStyle="red",t.font="48px sans-serif",t.fillText("Game Over",e/2-120,r/2),t.font="24px sans-serif",t.fillText("Press Space to Restart",e/2-110,r/2+50),t.fillStyle="gold",t.font="32px sans-serif",t.fillText("High Score: "+o,e/2-100,r/2-100),c&&(console.log("got high score"),t.fillStyle="red",t.fillText("New High Score!",e/2-100,r/2-50))}let l=[];function I(){l=[];for(let o=0;o<6;o++){let c=Math.floor(Math.random()*(e-n)),m=r-75*o-150;if(o>0){let x=l[o-1].position.y-100;m=Math.max(m,x)}let v=new u(new p(c,m),n,s,t,"./platform.png");l.push(v)}}function j(){let o=Math.floor(Math.random()*(e-n)),m=Math.min(...l.map(x=>x.position.y))-Math.random()*50-50,v=new u(new p(o,m),n,s,t,"./platform.png");l.push(v)}function E(){d=!1,f=0,a.reset(new p(e/2-23,r*7/8-46)),I(),l.push(new u(new p(e/2-n/2,r-50),n,s,t,"./platform.png")),g="playing"}let a=new A(new p(e/2-23,r*7/8-46),46,46,"./doodler-right.png","./doodler-left.png",t,k,y);I(),l.push(new u(new p(e/2-n/2,r-50),n,s,t,"./platform.png"));function P(){if(t.clearRect(0,0,i.width,i.height),w(),g==="start")L();else if(g==="playing"){if(d)M();else{if(a.update(),a.vy<0&&a.position.y<r/2){let o=-a.vy;l.forEach(c=>{c.position.y+=o}),a.position.y+=o}for(let o=l.length-1;o>=0;o--){let c=l[o];c.draw(),C(c,a)&&a.vy>=0&&a.jump(),c.position.y>r&&(l.splice(o,1),j(),f++)}a.draw(),a.position.y>r&&(d=!0)}t.fillStyle="blue",t.font="16px sans-serif",t.fillText(`Score: ${f}`,5,20)}requestAnimationFrame(P)}P(),document.addEventListener("keydown",o=>{(o.key==="Enter"&&g==="start"||o.key===" "&&g==="playing"&&d)&&E()})};
